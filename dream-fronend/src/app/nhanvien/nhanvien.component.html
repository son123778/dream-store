<!-- Danh sách Nhân Viên -->
<div class="container" *ngIf="state === 'list'">
  <h2>Quản lý Nhân Viên</h2>

  <!-- Tìm kiếm và Lọc -->
  <div class="search-filter">
    <input type="text" placeholder="Tìm kiếm nhân viên..." [(ngModel)]="searchTen" (input)="searchNhanVien()" />
    <div class="filter">
      <label>
        <input type="radio" name="status" value="" [(ngModel)]="filterTrangThai" (change)="filterNhanVien()" />
        Tất cả
      </label>
      <label>
        <input type="radio" name="status" value="1" [(ngModel)]="filterTrangThai" (change)="filterNhanVien()" />
        Đang làm
      </label>
      <label>
        <input type="radio" name="status" value="0" [(ngModel)]="filterTrangThai" (change)="filterNhanVien()" />
        Nghỉ việc
      </label>
    </div>
    
  </div>

  <!-- Nút Thêm Nhân Viên -->
  <button (click)="showCreateForm()">Thêm Nhân Viên</button>

  <!-- Bảng danh sách nhân viên -->
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Vai Trò</th>
        <th>Mã NV</th>
        <th>Tên</th>
        <th>Giới Tính</th>
        <th>Ngày Sinh</th>
        <th>Email</th>
        <th>SĐT</th>
        <th>Tài Khoản</th>
        <th>Mật Khẩu</th>
        <th>Ảnh</th>
        <th>Trạng Thái</th>
        <th>Ngày Tạo</th>
        <th>Ngày Sửa</th>
        <th>Hành Động</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let nhanVien of nhanViens">
        <td>{{ nhanVien.id }}</td>
        <td>{{ nhanVien.tenVaiTro }}</td>
        <td>{{ nhanVien.ma }}</td>
        <td>{{ nhanVien.ten }}</td>
        <td>{{ nhanVien.gioiTinh ? 'Nam' : 'Nữ' }}</td>
        <td>{{ nhanVien.ngaySinh }}</td>
        <td>{{ nhanVien.email }}</td>
        <td>{{ nhanVien.soDienThoai }}</td>
        <td>{{ nhanVien.taiKhoan }}</td>
        <td>{{ nhanVien.matKhau ? '******' : '' }}</td>
        <td>
          <img [src]="nhanVien.anh ? nhanVien.anh : 'assets/default-avatar.png'" alt="Ảnh nhân viên" width="50" />
        </td>
        <td>{{ nhanVien.trangThai === 1 ? 'Đang làm' : 'Nghỉ việc' }}</td>
        <td>{{ nhanVien.ngayTao }}</td>
        <td>{{ nhanVien.ngaySua }}</td>
        <td>
          <button (click)="showEditForm(nhanVien)">Sửa</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Form Thêm/Sửa Nhân Viên -->
<div *ngIf="state === 'form'" class="form-container">
  <h2>{{ isEditing ? 'Sửa Nhân Viên' : 'Thêm Nhân Viên' }}</h2>
  <form (ngSubmit)="saveNhanVien()">
    <div>
      <label>Vai Trò:</label>
      <select [(ngModel)]="currentNhanVien.idVaiTro" name="idVaiTro" required>
        <option *ngFor="let vaiTro of vaiTros" [value]="vaiTro.id">{{ vaiTro.ten }}</option>
      </select>
    </div>
    <div>
      <label>Mã NV:</label>
      <input type="text" [(ngModel)]="currentNhanVien.ma" name="ma" required />
    </div>
    <div>
      <label>Họ và Tên:</label>
      <input type="text" [(ngModel)]="currentNhanVien.ten" name="ten" required />
    </div>
    <div>
      <label>Giới Tính:</label>
      <label><input type="radio" [(ngModel)]="currentNhanVien.gioiTinh" [value]="true" name="gioiTinh" /> Nam</label>
      <label><input type="radio" [(ngModel)]="currentNhanVien.gioiTinh" [value]="false" name="gioiTinh" /> Nữ</label>
    </div>
    <div>
      <label>Ngày Sinh:</label>
      <input type="date" [(ngModel)]="currentNhanVien.ngaySinh" name="ngaySinh" required />
    </div>
    <div>
      <label>Email:</label>
      <input type="email" [(ngModel)]="currentNhanVien.email" name="email" required />
    </div>
    <div>
      <label>Số Điện Thoại:</label>
      <input type="text" [(ngModel)]="currentNhanVien.soDienThoai" name="soDienThoai" required />
    </div>
    <div>
      <label>Tài Khoản:</label>
      <input type="text" [(ngModel)]="currentNhanVien.taiKhoan" name="taiKhoan" required />
    </div>
    <div>
      <label>Mật Khẩu:</label>
      <input type="password" [(ngModel)]="currentNhanVien.matKhau" name="matKhau" required />
    </div>
    <div>
      <label>Ảnh:</label>
      <input type="file" (change)="onFileSelected($event)" />
    </div>
    <div>
      <label>Trạng Thái:</label>
      <select [(ngModel)]="currentNhanVien.trangThai" name="trangThai">
        <option value="1">Đang làm</option>
        <option value="0">Nghỉ việc</option>
      </select>
    </div>
    <div>
      <label>Ngày Tạo:</label>
      <input type="datetime-local" [(ngModel)]="currentNhanVien.ngayTao" name="ngayTao" [disabled]="isEditing" />
    </div>
    
    <div>
      <label>Ngày Sửa:</label>
      <input type="datetime-local" [(ngModel)]="currentNhanVien.ngaySua" name="ngaySua" readonly />
    </div>
    
    <button type="submit">{{ isEditing ? 'Lưu Thay Đổi' : 'Thêm' }}</button>
    <button type="button" (click)="backToList()">Hủy</button>
  </form>
</div>
